{"version":3,"sources":["webpack:///./server/renderedPageRouter.jsx?d701"],"names":["renderedPageRouter","get","req","res","routes","location","url","error","redirectLocation","renderProps","status","send","message","redirect","pathname","search","componentsWithData","components","filter","c","dataFetcher","dataFetchers","map","params","urlBase","cookie","headers","Promise","all","then","dataList","initialState","forEach","namedData","Object","assign","html","catch","err","console","log"],"mappings":";;;;;;;;;;;;AAAA;;;;AACA;;AACA;;AAEA;;;;AAEA;;;;AACA;;;;AACA;;;;;;AAEA,OAAMA,qBAAqB,uBAA3B;;AAEAA,oBAAmBC,GAAnB,CAAuB,GAAvB,EAA4B,CAACC,GAAD,EAAMC,GAAN,KAAc;AACxC,2BAAM,EAAEC,wBAAF,EAAUC,UAAUH,IAAII,GAAxB,EAAN,EAAqC,CAACC,KAAD,EAAQC,gBAAR,EAA0BC,WAA1B,KAA0C;AAC7E,SAAIF,KAAJ,EAAW;AACTJ,WAAIO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBJ,MAAMK,OAA3B;AACD,MAFD,MAEO,IAAIJ,gBAAJ,EAAsB;AAC3BL,WAAIU,QAAJ,CAAa,GAAb,EAAkBL,iBAAiBM,QAAjB,GAA4BN,iBAAiBO,MAA/D;AACD,MAFM,MAEA,IAAIN,WAAJ,EAAiB;AACtB,aAAMO,qBAAqBP,YAAYQ,UAAZ,CAAuBC,MAAvB,CAA8BC,KAAKA,EAAEC,WAArC,CAA3B;AACA,aAAMC,eAAeL,mBAAmBM,GAAnB,CAAuBH,KAAKA,EAAEC,WAAF,CAAc;AAC7DG,iBAAQd,YAAYc,MADyC,EACjClB,UAAUI,YAAYJ,QADW;AAE7DmB,kBAAS,uBAFoD,EAE3BC,QAAQvB,IAAIwB,OAAJ,CAAYD;AAFO,QAAd,CAA5B,CAArB;AAIAE,eAAQC,GAAR,CAAYP,YAAZ,EAA0BQ,IAA1B,CAAgCC,QAAD,IAAc;AAC3C,aAAIC,eAAe,EAAnB;AACAD,kBAASE,OAAT,CAAkBC,SAAD,IAAe;AAC9BF,0BAAeG,OAAOC,MAAP,CAAcJ,YAAd,EAA4BE,SAA5B,CAAf;AACD,UAFD;AAGA,eAAMG,OAAO,4BACX;AAAA;AAAA,aAAgB,cAAcL,YAA9B;AACE,qEAAmBtB,WAAnB;AADF,UADW,CAAb;AAKAN,aAAIO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,wBAASyB,IAAT,EAAeL,YAAf,CAArB;AACD,QAXD,EAYCM,KAZD,CAYOC,OAAO;AACZC,iBAAQC,GAAR,CAAa,8BAA6BF,GAAI,EAA9C;AACD,QAdD;AAeD,MArBM,MAqBA;AACLnC,WAAIO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,WAArB;AACD;AACF,IA7BD;AA8BD,EA/BD;;mBAiCeX,kB","file":"0.69b71d8d2f67df3eb6ff.hot-update.js","sourcesContent":["import React from 'react';\nimport { renderToString } from 'react-dom/server';\nimport { match, RouterContext } from 'react-router';\n\nimport Router from 'express';\n\nimport template from './template.js';\nimport routes from '../src/Routes.jsx';\nimport ContextWrapper from '../src/ContextWrapper.jsx';\n\nconst renderedPageRouter = new Router();\n\nrenderedPageRouter.get('*', (req, res) => {\n  match({ routes, location: req.url }, (error, redirectLocation, renderProps) => {\n    if (error) {\n      res.status(500).send(error.message);\n    } else if (redirectLocation) {\n      res.redirect(302, redirectLocation.pathname + redirectLocation.search);\n    } else if (renderProps) {\n      const componentsWithData = renderProps.components.filter(c => c.dataFetcher);\n      const dataFetchers = componentsWithData.map(c => c.dataFetcher({\n        params: renderProps.params, location: renderProps.location,\n        urlBase: 'http://localhost:3000', cookie: req.headers.cookie,\n      }));\n      Promise.all(dataFetchers).then((dataList) => {\n        let initialState = {};\n        dataList.forEach((namedData) => {\n          initialState = Object.assign(initialState, namedData);\n        });\n        const html = renderToString(\n          <ContextWrapper initialState={initialState} >\n            <RouterContext {...renderProps} />\n          </ContextWrapper>\n        );\n        res.status(200).send(template(html, initialState));\n      })\n      .catch(err => {\n        console.log(`Error rendering to string: ${err}`);\n      });\n    } else {\n      res.status(404).send('Not found');\n    }\n  });\n});\n\nexport default renderedPageRouter;\n\n\n\n// WEBPACK FOOTER //\n// ./server/renderedPageRouter.jsx"],"sourceRoot":""}