{"version":3,"sources":["webpack:///./src/IssueList.jsx?e290"],"names":["IssueRow","props","onDeleteClick","deleteIssue","issue","_id","substr","status","owner","created","toDateString","effort","completionDate","title","propTypes","PropTypes","object","isRequired","func","IssueTable","issueRows","issues","map","array","PAGE_SIZE","IssueList","Component","dataFetcher","urlBase","location","query","Object","assign","pageStr","_page","_offset","parseInt","_limit","search","keys","k","join","fetch","then","response","ok","json","error","Promise","reject","data","constructor","context","initialState","metadata","totalCount","records","forEach","Date","state","toastVisible","toastMessage","toastType","setFilter","bind","selectPage","showError","dismissToast","componentDidMount","loadData","componentDidUpdate","prevProps","oldQuery","newQuery","effort_gte","effort_lte","router","push","pathname","eventKey","message","setState","catch","err","id","method","render","Math","ceil","contextTypes"],"mappings":"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","file":"0.439a376d0ed2156f3e9c.hot-update.js","sourcesContent":["import React from 'react';\nimport 'isomorphic-fetch';\nimport { Link } from 'react-router';\nimport { Button, Glyphicon, Table, Panel, Pagination } from 'react-bootstrap';\n\nimport IssueFilter from './IssueFilter.jsx';\nimport Toast from './Toast.jsx';\n\nconst IssueRow = (props) => {\n  function onDeleteClick() {\n    props.deleteIssue(props.issue._id);\n  }\n\n  return (\n    <tr>\n      <td><Link to={`/issues/${props.issue._id}`}>{props.issue._id.substr(-4)}</Link></td>\n      <td>{props.issue.status}</td>\n      <td>{props.issue.owner}</td>\n      <td>{props.issue.created.toDateString()}</td>\n      <td>{props.issue.effort}</td>\n      <td>{props.issue.completionDate ? props.issue.completionDate.toDateString() : ''}</td>\n      <td>{props.issue.title}</td>\n      <td>\n        <Button bsSize=\"xsmall\" onClick={onDeleteClick}><Glyphicon glyph=\"trash\" /></Button>\n      </td>\n    </tr>\n  );\n};\n\nIssueRow.propTypes = {\n  issue: React.PropTypes.object.isRequired,\n  deleteIssue: React.PropTypes.func.isRequired,\n};\n\nfunction IssueTable(props) {\n  const issueRows = props.issues.map(issue =>\n    <IssueRow key={issue._id} issue={issue} deleteIssue={props.deleteIssue} />\n  );\n  return (\n    <Table bordered condensed hover responsive>\n      <thead>\n        <tr>\n          <th>Id</th>\n          <th>Status</th>\n          <th>Owner</th>\n          <th>Created</th>\n          <th>Effort</th>\n          <th>Completion Date</th>\n          <th>Title</th>\n          <th></th>\n        </tr>\n      </thead>\n      <tbody>{issueRows}</tbody>\n    </Table>\n  );\n}\n\nIssueTable.propTypes = {\n  issues: React.PropTypes.array.isRequired,\n  deleteIssue: React.PropTypes.func.isRequired,\n};\n\nconst PAGE_SIZE = 10;\n\nexport default class IssueList extends React.Component {\n  static dataFetcher({ urlBase, location }) {\n    const query = Object.assign({}, location.query);\n    const pageStr = query._page;\n    if (pageStr) {\n      delete query._page;\n      query._offset = (parseInt(pageStr, 10) - 1) * PAGE_SIZE;\n    }\n    query._limit = PAGE_SIZE;\n    const search = Object.keys(query).map(k => `${k}=${query[k]}`).join('&');\n    return fetch(`${urlBase || ''}/api/issues?${search}`).then(response => {\n      if (!response.ok) return response.json().then(error => Promise.reject(error));\n      return response.json().then(data => ({ IssueList: data }));\n    });\n  }\n\n  constructor(props, context) {\n    super(props, context);\n    const data = context.initialState.IssueList ? context.initialState.IssueList\n      : { metadata: { totalCount: 0 }, records: [] };\n    const issues = data.records;\n    issues.forEach(issue => {\n      issue.created = new Date(issue.created);\n      if (issue.completionDate) {\n        issue.completionDate = new Date(issue.completionDate);\n      }\n    });\n    this.state = {\n      issues,\n      toastVisible: false, toastMessage: '', toastType: 'success',\n      totalCount: data.metadata.totalCount,\n    };\n\n    this.setFilter = this.setFilter.bind(this);\n    this.selectPage = this.selectPage.bind(this);\n    this.deleteIssue = this.deleteIssue.bind(this);\n    this.showError = this.showError.bind(this);\n    this.dismissToast = this.dismissToast.bind(this);\n  }\n\n  componentDidMount() {\n    this.loadData();\n  }\n\n  componentDidUpdate(prevProps) {\n    const oldQuery = prevProps.location.query;\n    const newQuery = this.props.location.query;\n    if (oldQuery.status === newQuery.status\n        && oldQuery.effort_gte === newQuery.effort_gte\n        && oldQuery.effort_lte === newQuery.effort_lte\n        && oldQuery._page === newQuery._page) {\n      return;\n    }\n    this.loadData();\n  }\n\n  setFilter(query) {\n    this.props.router.push({ pathname: this.props.location.pathname, query });\n  }\n\n  selectPage(eventKey) {\n    const query = Object.assign(this.props.location.query, { _page: eventKey });\n    this.props.router.push({ pathname: this.props.location.pathname, query });\n  }\n\n  showError(message) {\n    this.setState({ toastVisible: true, toastMessage: message, toastType: 'danger' });\n  }\n\n  dismissToast() {\n    this.setState({ toastVisible: false });\n  }\n\n  loadData() {\n    IssueList.dataFetcher({ location: this.props.location })\n    .then(data => {\n      const issues = data.IssueList.records;\n      issues.forEach(issue => {\n        issue.created = new Date(issue.created);\n        if (issue.completionDate) {\n          issue.completionDate = new Date(issue.completionDate);\n        }\n      });\n      this.setState({ issues, totalCount: data.IssueList.metadata.totalCount });\n    }).catch(err => {\n      this.showError(`Error in fetching data from server: ${err}`);\n    });\n  }\n\n  deleteIssue(id) {\n    fetch(`/api/issues/${id}`, { method: 'DELETE' }).then(response => {\n      if (!response.ok) this.showError('Failed to delete issue');\n      else this.loadData();\n    });\n  }\n\n  render() {\n    return (\n      <div>\n        <Panel collapsible header=\"Filter\">\n          <IssueFilter setFilter={this.setFilter} initFilter={this.props.location.query} />\n        </Panel>\n        <Pagination\n          items={Math.ceil(this.state.totalCount / PAGE_SIZE)}\n          activePage={parseInt(this.props.location.query._page || '1', 10)}\n          onSelect={this.selectPage} maxButtons={7} next prev boundaryLinks\n        />\n        <IssueTable issues={this.state.issues} deleteIssue={this.deleteIssue} />\n        <Toast\n          showing={this.state.toastVisible} message={this.state.toastMessage}\n          onDismiss={this.dismissToast} bsStyle={this.state.toastType}\n        />\n      </div>\n    );\n  }\n}\n\nIssueList.propTypes = {\n  location: React.PropTypes.object.isRequired,\n  router: React.PropTypes.object,\n};\n\nIssueList.contextTypes = {\n  initialState: React.PropTypes.object,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/IssueList.jsx"],"sourceRoot":""}