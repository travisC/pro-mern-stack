{"version":3,"sources":["webpack:///./src/SigninNavItem.jsx?c729"],"names":["SigninNavItem","Component","constructor","props","state","showing","disabled","showModal","bind","hideModal","signout","signin","componentDidMount","window","gapi","load","auth2","getAuthInstance","config","googleClientId","showError","init","client_id","then","setState","signIn","googleUser","fetch","method","headers","body","JSON","stringify","id_token","getAuthResponse","response","ok","json","user","onSignin","name","error","catch","err","signOut","showSuccess","onSignout","render","signedIn","propTypes","PropTypes","object","func","isRequired"],"mappings":";;;;;;;;;;;;AAAA;;;;AACA;;;;AAEe,OAAMA,aAAN,SAA4B,gBAAMC,SAAlC,CAA4C;AACzDC,eAAYC,KAAZ,EAAmB;AACjB,WAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACXC,gBAAS,KADE,EACKC,UAAU;AADf,MAAb;AAGA,UAAKC,SAAL,GAAiB,KAAKA,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAAjB;AACA,UAAKC,SAAL,GAAiB,KAAKA,SAAL,CAAeD,IAAf,CAAoB,IAApB,CAAjB;AACA,UAAKE,OAAL,GAAe,KAAKA,OAAL,CAAaF,IAAb,CAAkB,IAAlB,CAAf;AACA,UAAKG,MAAL,GAAc,KAAKA,MAAL,CAAYH,IAAZ,CAAiB,IAAjB,CAAd;AACD;;AAEDI,uBAAoB;AAClBC,YAAOC,IAAP,CAAYC,IAAZ,CAAiB,OAAjB,EAA0B,MAAM;AAC9B,WAAI,CAACF,OAAOC,IAAP,CAAYE,KAAZ,CAAkBC,eAAlB,EAAL,EAA0C;AACxC,aAAI,CAACJ,OAAOK,MAAR,IAAkB,CAACL,OAAOK,MAAP,CAAcC,cAArC,EAAqD;AACnD,gBAAKhB,KAAL,CAAWiB,SAAX,CAAqB,2DAArB;AACD,UAFD,MAEO;AACLP,kBAAOC,IAAP,CAAYE,KAAZ,CAAkBK,IAAlB,CAAuB,EAAEC,WAAWT,OAAOK,MAAP,CAAcC,cAA3B,EAAvB,EAAoEI,IAApE,CAAyE,MAAM;AAC7E,kBAAKC,QAAL,CAAc,EAAElB,UAAU,KAAZ,EAAd;AACD,YAFD;AAGD;AACF;AACF,MAVD;AAWD;;AAEDK,YAAS;AACP,UAAKF,SAAL;AACA,WAAMO,QAAQH,OAAOC,IAAP,CAAYE,KAAZ,CAAkBC,eAAlB,EAAd;AACAD,WAAMS,MAAN,GAAeF,IAAf,CAAoBG,cAAc;AAChCC,aAAM,SAAN,EAAiB;AACfC,iBAAQ,MADO;AAEfC,kBAAS,EAAE,gBAAgB,kBAAlB,EAFM;AAGfC,eAAMC,KAAKC,SAAL,CAAe,EAAEC,UAAUP,WAAWQ,eAAX,GAA6BD,QAAzC,EAAf;AAHS,QAAjB,EAIGV,IAJH,CAIQY,YAAY;AAClB,aAAIA,SAASC,EAAb,EAAiB;AACfD,oBAASE,IAAT,GAAgBd,IAAhB,CAAqBe,QAAQ;AAC3B,kBAAKnC,KAAL,CAAWoC,QAAX,CAAoBD,KAAKE,IAAzB;AACD,YAFD;AAGD,UAJD,MAIO;AACLL,oBAASE,IAAT,GAAgBd,IAAhB,CAAqBkB,SAAS;AAC5B,kBAAKtC,KAAL,CAAWiB,SAAX,CAAsB,qBAAoBqB,KAAM,EAAhD;AACD,YAFD;AAGD;AACF,QAdD,EAeCC,KAfD,CAeOC,OAAO;AACZ,cAAKxC,KAAL,CAAWiB,SAAX,CAAsB,+BAA8BuB,GAAI,EAAxD;AACD,QAjBD;AAkBD,MAnBD,EAmBGF,SAAS;AACV,YAAKtC,KAAL,CAAWiB,SAAX,CAAsB,qCAAoCqB,KAAM,EAAhE;AACD,MArBD;AAsBD;;AAED/B,aAAU;AACR,WAAMM,QAAQH,OAAOC,IAAP,CAAYE,KAAZ,CAAkBC,eAAlB,EAAd;AACAU,WAAM,UAAN,EAAkB;AAChBC,eAAQ,MADQ;AAEhBC,gBAAS,EAAE,gBAAgB,kBAAlB;AAFO,MAAlB,EAGGN,IAHH,CAGQY,YAAY;AAClB,WAAIA,SAASC,EAAb,EAAiB;AACfpB,eAAM4B,OAAN,GAAgBrB,IAAhB,CAAqB,MAAM;AACzB,gBAAKpB,KAAL,CAAW0C,WAAX,CAAuB,0BAAvB;AACA,gBAAK1C,KAAL,CAAW2C,SAAX;AACD,UAHD;AAID;AACF,MAVD;AAWD;;AAEDvC,eAAY;AACV,SAAI,KAAKH,KAAL,CAAWE,QAAf,EAAyB;AACvB,YAAKH,KAAL,CAAWiB,SAAX,CAAqB,2DAArB;AACD,MAFD,MAEO;AACL,YAAKI,QAAL,CAAc,EAAEnB,SAAS,IAAX,EAAd;AACD;AACF;;AAEDI,eAAY;AACV,UAAKe,QAAL,CAAc,EAAEnB,SAAS,KAAX,EAAd;AACD;;AAED0C,YAAS;AACP,SAAI,KAAK5C,KAAL,CAAWmC,IAAX,CAAgBU,QAApB,EAA8B;AAC5B,cACE;AAAA;AAAA,WAAa,OAAO,KAAK7C,KAAL,CAAWmC,IAAX,CAAgBE,IAApC,EAA0C,IAAG,eAA7C;AACE;AAAA;AAAA,aAAU,SAAS,KAAK9B,OAAxB;AAAA;AAAA;AADF,QADF;AAKD;AACD,YACE;AAAA;AAAA,SAAS,SAAS,KAAKH,SAAvB;AAAA;AACE;AAAA;AAAA,WAAO,cAAP,EAAgB,MAAM,KAAKH,KAAL,CAAWC,OAAjC,EAA0C,QAAQ,KAAKI,SAAvD,EAAkE,QAAO,IAAzE;AACE;AAAA,iCAAO,MAAP;AAAA,aAAc,iBAAd;AACE;AAAA,mCAAO,KAAP;AAAA;AAAA;AAAA;AADF,UADF;AAIE;AAAA,iCAAO,IAAP;AAAA;AACE;AAAA;AAAA,eAAQ,WAAR,EAAc,UAAU,KAAKL,KAAL,CAAWE,QAAnC,EAA6C,SAAS,KAAKK,MAA3D;AACE,oDAAK,KAAI,wCAAT,EAAkD,KAAI,SAAtD;AADF;AADF,UAJF;AASE;AAAA,iCAAO,MAAP;AAAA;AACE;AAAA;AAAA,eAAQ,SAAQ,MAAhB,EAAuB,SAAS,KAAKF,SAArC;AAAA;AAAA;AADF;AATF;AADF,MADF;AAiBD;AAzGwD;;mBAAtCT,a;AA4GrBA,eAAciD,SAAd,GAA0B;AACxBX,SAAM,gBAAMY,SAAN,CAAgBC,MADE;AAExBZ,aAAU,gBAAMW,SAAN,CAAgBE,IAAhB,CAAqBC,UAFP;AAGxBP,cAAW,gBAAMI,SAAN,CAAgBE,IAAhB,CAAqBC,UAHR;AAIxBjC,cAAW,gBAAM8B,SAAN,CAAgBE,IAAhB,CAAqBC,UAJR;AAKxBR,gBAAa,gBAAMK,SAAN,CAAgBE,IAAhB,CAAqBC;AALV,EAA1B,C","file":"0.621a9d3621e7bdf51142.hot-update.js","sourcesContent":["import React from 'react';\nimport { NavItem, Modal, Button, NavDropdown, MenuItem } from 'react-bootstrap';\n\nexport default class SigninNavItem extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showing: false, disabled: true,\n    };\n    this.showModal = this.showModal.bind(this);\n    this.hideModal = this.hideModal.bind(this);\n    this.signout = this.signout.bind(this);\n    this.signin = this.signin.bind(this);\n  }\n\n  componentDidMount() {\n    window.gapi.load('auth2', () => {\n      if (!window.gapi.auth2.getAuthInstance()) {\n        if (!window.config || !window.config.googleClientId) {\n          this.props.showError('Missing Google Client ID or config file /static.config.js');\n        } else {\n          window.gapi.auth2.init({ client_id: window.config.googleClientId }).then(() => {\n            this.setState({ disabled: false });\n          });\n        }\n      }\n    });\n  }\n\n  signin() {\n    this.hideModal();\n    const auth2 = window.gapi.auth2.getAuthInstance();\n    auth2.signIn().then(googleUser => {\n      fetch('/signin', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ id_token: googleUser.getAuthResponse().id_token }),\n      }).then(response => {\n        if (response.ok) {\n          response.json().then(user => {\n            this.props.onSignin(user.name);\n          });\n        } else {\n          response.json().then(error => {\n            this.props.showError(`App login failed: ${error}`);\n          });\n        }\n      })\n      .catch(err => {\n        this.props.showError(`Error posting login to app: ${err}`);\n      });\n    }, error => {\n      this.props.showError(`Error authenticating with Google: ${error}`);\n    });\n  }\n\n  signout() {\n    const auth2 = window.gapi.auth2.getAuthInstance();\n    fetch('/signout', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n    }).then(response => {\n      if (response.ok) {\n        auth2.signOut().then(() => {\n          this.props.showSuccess('Successfully signed out.');\n          this.props.onSignout();\n        });\n      }\n    });\n  }\n\n  showModal() {\n    if (this.state.disabled) {\n      this.props.showError('Missing Google Client ID or config file /static.config.js');\n    } else {\n      this.setState({ showing: true });\n    }\n  }\n\n  hideModal() {\n    this.setState({ showing: false });\n  }\n\n  render() {\n    if (this.props.user.signedIn) {\n      return (\n        <NavDropdown title={this.props.user.name} id=\"user-dropdown\">\n          <MenuItem onClick={this.signout}>Sign out</MenuItem>\n        </NavDropdown>\n      );\n    }\n    return (\n      <NavItem onClick={this.showModal}>Sign in\n        <Modal keyboard show={this.state.showing} onHide={this.hideModal} bsSize=\"sm\">\n          <Modal.Header closeButton>\n            <Modal.Title>Sign in</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <Button block disabled={this.state.disabled} onClick={this.signin}>\n              <img src=\"/btn_google_signin_dark_normal_web.png\" alt=\"Sign in\" />\n            </Button>\n          </Modal.Body>\n          <Modal.Footer>\n            <Button bsStyle=\"link\" onClick={this.hideModal}>Cancel</Button>\n          </Modal.Footer>\n        </Modal>\n      </NavItem>\n    );\n  }\n}\n\nSigninNavItem.propTypes = {\n  user: React.PropTypes.object,\n  onSignin: React.PropTypes.func.isRequired,\n  onSignout: React.PropTypes.func.isRequired,\n  showError: React.PropTypes.func.isRequired,\n  showSuccess: React.PropTypes.func.isRequired,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/SigninNavItem.jsx"],"sourceRoot":""}